{% extends 'components/table/table.html' %}

{% block columns %}
    <th scope="col">ID</th>
    <th scope="col">Usuario</th>
    <th scope="col">Email</th>
    <th scope="col">Rol</th>
    <th scope="col">Estado</th>
    <th scope="col">Fecha de uni贸n</th>
{% endblock columns %}

{% block rows %}
    <td>{{ item.id }}</td>
    <td>
        <div class="d-flex align-items-center">
            <div class="me-2">
                <i class="fa-solid fa-user-circle fa-2x text-primary"></i>
            </div>
            <div>
                <strong>{{ item.user.username }}</strong>
                {% if item.user.first_name or item.user.last_name %}
                <br>
                <small class="text-muted">
                    {{ item.user.first_name }} {{ item.user.last_name }}
                </small>
                {% endif %}
            </div>
        </div>
    </td>
    <td>{{ item.user.email|default:"-" }}</td>
    <td>
        {% if item.role == 'admin' %}
            <span class="badge bg-danger">
                <i class="fa-solid fa-crown"></i> {{ item.get_role_display }}
            </span>
        {% elif item.role == 'moderator' %}
            <span class="badge bg-warning text-dark">
                <i class="fa-solid fa-shield-alt"></i> {{ item.get_role_display }}
            </span>
        {% else %}
            <span class="badge bg-secondary">
                <i class="fa-solid fa-user"></i> {{ item.get_role_display }}
            </span>
        {% endif %}
    </td>
    <td>
        {% if item.is_verified %}
            <span class="badge bg-success">
                <i class="fa-solid fa-check-circle"></i> Verificado
            </span>
        {% else %}
            <span class="badge bg-warning text-dark">
                <i class="fa-solid fa-clock"></i> Pendiente
            </span>
        {% endif %}
    </td>
    <td>{{ item.joined_at|date:"d/m/Y H:i" }}</td>
{% endblock %}
<div class="card mb-4">
    <div class="card-body">
        <h5 class="card-title mb-3">
            <i class="bi bi-search"></i> Buscar Miembros
        </h5>
        <form method="GET" action="">
            <div class="row g-3">
                <!-- Filtro por rol -->
                <div class="col-md-5">
                    <label for="role" class="form-label">
                        <i class="fa-solid fa-user-tag"></i> Rol
                    </label>
                    <select name="role" id="role" class="form-select">
                        <option value="">Todos los roles</option>
                        {% for value, label in role_choices %}
                            <option value="{{ value }}" {% if request.GET.role == value %}selected{% endif %}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Filtro por verificaci贸n -->
                <div class="col-md-5">
                    <label for="is_verified" class="form-label">
                        <i class="fa-solid fa-check-circle"></i> Estado de verificaci贸n
                    </label>
                    <select name="is_verified" id="is_verified" class="form-select">
                        <option value="">Todos</option>
                        <option value="true" {% if request.GET.is_verified == 'true' %}selected{% endif %}>
                            Verificados
                        </option>
                        <option value="false" {% if request.GET.is_verified == 'false' %}selected{% endif %}>
                            No verificados
                        </option>
                    </select>
                </div>

                <!-- Botones de acci贸n -->
                <div class="col-md-2">
                    <label class="form-label d-block">&nbsp;</label>
                    <div class="d-flex gap-2">
                        {% include 'components/button/button.html' with type="submit" text="Buscar" icon="bi bi-search" style="primary" class="flex-grow-1" %}
                        <a href="{% url 'community:community_members' community.pk %}" class="btn btn-outline-secondary"
                           title="Limpiar filtros">
                            <i class="fa-solid fa-x"></i>
                        </a>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

